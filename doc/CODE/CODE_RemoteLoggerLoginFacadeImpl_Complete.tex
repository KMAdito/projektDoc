\begin{spacing}{0.75}
	\begin{javacode}
/**
 * Login-Facade, damit sich der RemoteLogger-Client nur dann wirklich
 * einloggen kann, wenn die Login-Daten stimmen!
 *
 * @author W.Glanzer, 26.11.2015
 */
public class RemoteLoggerLoginFacadeImpl implements IRemoteLoggerLoginFacade
{
  private final SecurityPrefs securityPrefs;
  private final LoginPrefs loginPrefs;
  private final Locale locale;
  private final IUserDirectoryExt userDirectory;

  public RemoteLoggerLoginFacadeImpl(@NotNull SecurityPrefs pSecurityPrefs, 
                                     @NotNull LoginPrefs pLoginPrefs,
                                     @Nullable Locale pLocale, 
                                     IUserDirectoryExt pUserDirectory)
  {
    securityPrefs = pSecurityPrefs;
    loginPrefs = pLoginPrefs;
    locale = pLocale;
    userDirectory = pUserDirectory;
  }

  @Override
  public boolean checkLogin(@NotNull String[] pLoginInformation)
  {
    ManagerLoginUtil.LoginResult result = ManagerLoginUtil.checkLogin(pLoginInformation, 
                                          securityPrefs, loginPrefs, locale, userDirectory);
  
    // Überprüft gleichzeitig, ob der hinter den Login-Informationen liegende Benutzer
    // die passende Rolle besitzt.
    return result.wasOK() && UserUtility.hasRole(result.getUser(), InternalRoles.ADMIN);
  }
}  \end{javacode}
\end{spacing}